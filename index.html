<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电子校园卡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #000;
            overflow: hidden;
            height: 100vh;
            display: grid;
            place-items: center;
        }
        
        .photo-container {
            width: 100%;
            height: 100%;
            display: grid;
            place-items: center;
            position: relative;
        }
        
        .photo {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            display: block;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .photo.loaded {
            opacity: 1;
        }
        
        .loading {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
            z-index: 10;
        }
        
        .progress-bar {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            display: none;
        }
        
        .progress-fill {
            height: 100%;
            width: 0%;
            background: #fff;
            transition: width 0.3s ease;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 移动设备优化 */
        @media (max-width: 768px) {
            .photo {
                width: 100%;
                height: auto;
            }
            
            /* 针对竖屏照片优化 */
            @media (orientation: portrait) {
                .photo {
                    width: auto;
                    height: 100%;
                }
            }
            
            .progress-bar {
                width: 120px;
                bottom: 15px;
                left: 15px;
            }
        }
        
        /* 防止图片过小导致显示问题 */
        @media (min-width: 1200px) {
            .photo {
                max-width: 90vw;
                max-height: 90vh;
            }
        }
    </style>
</head>
<body>
    <div class="photo-container">
        <!-- 初始显示一个低质量占位符，快速显示 -->
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiMxMTExMTEiLz48L3N2Zz4=" 
             alt="" 
             class="photo" 
             id="mainPhoto">
        <div class="loading" id="loadingIndicator"></div>
        <div class="progress-bar" id="progressBar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <script>
        // 图片预加载和渐进式加载
        document.addEventListener('DOMContentLoaded', function() {
            const photo = document.getElementById('mainPhoto');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            
            // 使用相对路径指向photo.jpg
            const imageUrl = 'photo.jpg';
            
            // 创建新的Image对象进行预加载
            const img = new Image();
            
            // 监听加载进度（如果浏览器支持）
            if ('onprogress' in img) {
                img.onprogress = function(e) {
                    if (e.lengthComputable) {
                        const percentComplete = (e.loaded / e.total) * 100;
                        progressFill.style.width = percentComplete + '%';
                    }
                };
            }
            
            // 图片开始加载时显示进度条
            img.onloadstart = function() {
                progressBar.style.display = 'block';
            };
            
            // 图片加载完成
            img.onload = function() {
                // 将加载的图片设置为显示的图片
                photo.src = imageUrl;
                photo.classList.add('loaded');
                
                // 隐藏加载指示器和进度条
                loadingIndicator.style.display = 'none';
                progressBar.style.display = 'none';
            };
            
            // 图片加载错误处理
            img.onerror = function() {
                console.error('图片加载失败，请确保photo.jpg文件存在');
                loadingIndicator.style.display = 'none';
                progressBar.style.display = 'none';
                
                // 可以在这里添加错误处理，比如显示默认图片
                photo.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiM0NDQiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE4IiBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+5Zu+54mH5paH5Lu25LiN6IO95Li656m6PC90ZXh0Pjwvc3ZnPg==';
                photo.classList.add('loaded');
            };
            
            // 开始加载图片
            img.src = imageUrl;
            
            // 如果浏览器支持，添加优先级提示
            if (photo.fetchPriority) {
                photo.fetchPriority = 'high';
            }
            
            // 如果浏览器支持，添加预加载链接
            const preloadLink = document.createElement('link');
            preloadLink.rel = 'preload';
            preloadLink.as = 'image';
            preloadLink.href = imageUrl;
            document.head.appendChild(preloadLink);
        });
    </script>
</body>
</html>

